# æ•°æ®ä¿å­˜é—®é¢˜ä¿®å¤æŒ‡å—

## ğŸ› ï¸ ä¿®å¤æ­¥éª¤

### ç¬¬ä¸€æ­¥ï¼šè¿è¡Œä¿®å¤ç‰ˆæ•°æ®åº“è®¾è®¡
```sql
\i student_learning_info_design_safe.sql
```

### ç¬¬äºŒæ­¥ï¼šè¿è¡ŒAPIå‡½æ•°
```sql
\i student_learning_api_functions_final.sql
```

### ç¬¬ä¸‰æ­¥ï¼šè°ƒè¯•æ•°æ®åº“çŠ¶æ€
```sql
\i debug_simple.sql
```

### ç¬¬å››æ­¥ï¼šæµ‹è¯•æ’å…¥åŠŸèƒ½
```sql
\i test_simple_insert.sql
```

## ğŸ” é—®é¢˜è¯Šæ–­æµç¨‹

### 1. å¦‚æœè¿è¡Œdebug_simple.sqlåå‘ç°é—®é¢˜
- **æ²¡æœ‰student_profilesè®°å½•** â†’ éœ€è¦åˆ›å»ºå­¦ç”Ÿæ•°æ®
- **è¡¨ä¸å­˜åœ¨** â†’ æ•°æ®åº“è®¾è®¡æœªæˆåŠŸåˆ›å»º
- **RLSå¯ç”¨** â†’ éœ€è¦ç¦ç”¨RLSç­–ç•¥

### 2. å¦‚æœæµ‹è¯•æ’å…¥æˆåŠŸä½†å‰ç«¯æ— æ³•ä¿å­˜
- **å‰ç«¯APIè°ƒç”¨é”™è¯¯** â†’ æ£€æŸ¥JavaScriptä»£ç 
- **å‚æ•°ä¸åŒ¹é…** â†’ æ£€æŸ¥APIå‚æ•°åç§°
- **æƒé™é—®é¢˜** â†’ æ£€æŸ¥ç”¨æˆ·æƒé™è®¾ç½®

### 3. å¸¸è§é”™è¯¯ä¿®å¤

#### é”™è¯¯ï¼šæ²¡æœ‰å­¦ç”Ÿæ•°æ®å¯å…³è”
```sql
-- åˆ›å»ºæµ‹è¯•å­¦ç”Ÿ
INSERT INTO student_profiles (user_id, student_number, full_name, class_name)
SELECT id, 'TEST001', 'æµ‹è¯•å­¦ç”Ÿ', 'æµ‹è¯•ç­çº§' 
FROM users WHERE username = 'ä½ çš„ç”¨æˆ·å';
```

#### é”™è¯¯ï¼šRLSç­–ç•¥é˜»æ­¢
```sql
-- ç¦ç”¨RLSç­–ç•¥
ALTER TABLE student_technical_tags DISABLE ROW LEVEL SECURITY;
ALTER TABLE student_learning_achievements DISABLE ROW LEVEL SECURITY;
ALTER TABLE student_learning_outcomes DISABLE ROW LEVEL SECURITY;
ALTER TABLE student_proof_materials DISABLE ROW LEVEL SECURITY;
```

#### é”™è¯¯ï¼šå‰ç«¯APIè°ƒç”¨æ ¼å¼é”™è¯¯
```javascript
// æ­£ç¡®çš„è°ƒç”¨æ ¼å¼
const { data, error } = await supabase.rpc('add_student_technical_tag', {
  p_student_profile_id: 'profileçš„UUID',
  p_tag_name: 'JavaScript',
  p_tag_category: 'ç¼–ç¨‹è¯­è¨€', 
  p_proficiency_level: 'intermediate',
  p_learned_at: '2024-01-15'
});
```

## ğŸ“Š éªŒè¯æ­¥éª¤

è¿è¡Œæµ‹è¯•è„šæœ¬åï¼Œåº”è¯¥çœ‹åˆ°ï¼š
- âœ… æ‰€æœ‰è¡¨å­˜åœ¨
- âœ… æµ‹è¯•æ•°æ®æˆåŠŸæ’å…¥
- âœ… APIå‡½æ•°å¯æ­£å¸¸è°ƒç”¨

## ğŸš¨ å¦‚æœä»ç„¶æœ‰é—®é¢˜

è¯·æä¾›ï¼š
1. **debug_simple.sqlçš„è¾“å‡ºç»“æœ**
2. **test_simple_insert.sqlçš„æ‰§è¡Œç»“æœ**
3. **å‰ç«¯æ§åˆ¶å°çš„å…·ä½“é”™è¯¯ä¿¡æ¯**
4. **ç½‘ç»œè¯·æ±‚çš„Payloadå†…å®¹**

è¿™æ ·æˆ‘å°±èƒ½è¿›ä¸€æ­¥å¸®ä½ å®šä½å’Œè§£å†³é—®é¢˜ï¼

## ğŸ’¡ å¿«é€ŸéªŒè¯æ–¹æ³•

è¿è¡Œä»¥ä¸‹SQLæŸ¥çœ‹æœ€ç»ˆç»“æœï¼š
```sql
-- æŸ¥çœ‹æ‰€æœ‰æµ‹è¯•æ•°æ®
SELECT 'æŠ€æœ¯æ ‡ç­¾' as type, COUNT(*) as count FROM student_technical_tags WHERE tag_name LIKE 'æµ‹è¯•%'
UNION ALL
SELECT 'å­¦ä¹ æ”¶è·', COUNT(*) FROM student_learning_achievements WHERE title LIKE 'æµ‹è¯•%'
UNION ALL
SELECT 'å­¦ä¹ æˆæœ', COUNT(*) FROM student_learning_outcomes WHERE outcome_title LIKE 'æµ‹è¯•%'
UNION ALL
SELECT 'è¯æ˜ææ–™', COUNT(*) FROM student_proof_materials WHERE material_name LIKE 'æµ‹è¯•%';
```