# 学生自定义课程功能更新说明

## 概述
本次更新为学生自定义课程功能增加了两个新字段：课程代码和课程性质，以丰富课程信息并提供更完整的数据记录。

## 更新内容

### 1. 数据库表结构更新
- **表名**: `student_custom_courses`
- **新增字段**:
  1. `course_code` (VARCHAR(20)) - 课程代码字段
  2. `course_nature` (VARCHAR(20)) - 课程性质字段，可选值为"必修课"或"选修课"

### 2. 后端API更新
- **接口路径**: `/api/add-custom-course`
- **新增参数**:
  1. `course_code` - 课程代码（可选）
  2. `course_nature` - 课程性质（可选，默认为"选修课"）
- **返回数据**: 增加了course_code和course_nature字段

### 3. 前端界面更新
- **添加课程弹窗**: 增加了课程代码和课程性质输入字段
- **课程列表显示**: 在课程信息中显示课程代码和课程性质

## 实施步骤

### 1. 数据库更新
执行以下SQL语句更新数据库表结构：

```sql
-- 添加课程代码字段
ALTER TABLE student_custom_courses 
ADD COLUMN IF NOT EXISTS course_code VARCHAR(20);

-- 添加课程性质字段
ALTER TABLE student_custom_courses 
ADD COLUMN IF NOT EXISTS course_nature VARCHAR(20) DEFAULT '选修课' 
CHECK (course_nature IN ('必修课', '选修课'));

-- 更新现有记录的课程性质默认值
UPDATE student_custom_courses 
SET course_nature = '选修课' 
WHERE course_nature IS NULL;

-- 创建索引以提高查询性能
CREATE INDEX IF NOT EXISTS idx_student_custom_courses_course_code 
ON student_custom_courses(course_code);
```

### 2. 重启服务
更新完成后，需要重启API服务以使更改生效。

## 测试验证

### 1. 功能测试
- [ ] 添加带课程代码的新课程
- [ ] 添加带课程性质的新课程
- [ ] 同时添加课程代码和课程性质
- [ ] 验证课程列表正确显示新字段

### 2. 兼容性测试
- [ ] 确保不填写新字段时仍能正常添加课程
- [ ] 验证现有课程数据显示正常
- [ ] 检查API接口向后兼容性

## 注意事项

1. **数据迁移**: 现有课程记录的course_nature字段将默认设置为"选修课"
2. **字段可选**: 新增字段均为可选字段，不影响现有功能
3. **界面适配**: 前端界面已适配新字段显示
4. **API文档**: 已更新相关API文档

## 相关文件

1. `update_student_custom_courses_table.sql` - 数据库更新脚本
2. `student_custom_courses_api.md` - API接口文档
3. `src/pages/p-student_academic_tasks/index.tsx` - 前端页面文件

---
**更新日期**: 2024-12-18  
**更新人员**: 开发团队